"use strict";(self.webpackChunkkrebit_apidocs=self.webpackChunkkrebit_apidocs||[]).push([[6087],{76494:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>o,default:()=>l,frontMatter:()=>a,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"getting-started/authentication","title":"Authenticate with Krebit Sign","description":"Obtain and refresh OAuth 2.0 bearer tokens for the Krebit Sign API using Authorization Code and refresh token grants.","source":"@site/docs/getting-started/authentication.md","sourceDirName":"getting-started","slug":"/getting-started/authentication","permalink":"/docs/getting-started/authentication","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"title":"Authenticate with Krebit Sign","description":"Obtain and refresh OAuth 2.0 bearer tokens for the Krebit Sign API using Authorization Code and refresh token grants."},"sidebar":"tutorialSidebar","previous":{"title":"Quickstart: Send your first signing","permalink":"/docs/getting-started/quickstart-signing"},"next":{"title":"Quickstart: AI prompts","permalink":"/docs/getting-started/ai-prompts"}}');var i=n(74848),s=n(28453);const a={sidebar_position:2,title:"Authenticate with Krebit Sign",description:"Obtain and refresh OAuth 2.0 bearer tokens for the Krebit Sign API using Authorization Code and refresh token grants."},o="Authenticate with Krebit Sign",d={},c=[{value:"Supported OAuth 2.0 grants",id:"supported-oauth-20-grants",level:2},{value:"Register an OAuth application",id:"register-an-oauth-application",level:2},{value:"Authorization Code example",id:"authorization-code-example",level:2},{value:"Refresh a token",id:"refresh-a-token",level:3},{value:"Send authenticated API calls",id:"send-authenticated-api-calls",level:2},{value:"Security best practices",id:"security-best-practices",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2}];function h(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"authenticate-with-krebit-sign",children:"Authenticate with Krebit Sign"})}),"\n",(0,i.jsxs)(t.p,{children:["Krebit Sign secures every request with OAuth 2.0 bearer tokens issued from your tenant at ",(0,i.jsx)(t.code,{children:"https://{organization}.krebit.se"}),". Every REST endpoint lives beneath ",(0,i.jsx)(t.code,{children:"/api/1.0"}),", and any call without a valid token is rejected with ",(0,i.jsx)(t.code,{children:"401 Unauthorized"}),"."]}),"\n",(0,i.jsx)(t.p,{children:"This guide explains how to register OAuth applications, choose the right grant type, and keep tokens fresh so that follow-on guides (such as the Quickstart) work end to end."}),"\n",(0,i.jsx)(t.h2,{id:"supported-oauth-20-grants",children:"Supported OAuth 2.0 grants"}),"\n",(0,i.jsx)(t.p,{children:"Krebit Sign supports two OAuth 2.0 grant types. Select the one that matches your integration pattern:"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Flow"}),(0,i.jsx)(t.th,{children:"When to use it"}),(0,i.jsx)(t.th,{children:"Notes"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.strong,{children:"Authorization Code"})}),(0,i.jsx)(t.td,{children:"User-facing apps where an operator grants consent."}),(0,i.jsxs)(t.td,{children:["Returns both access and refresh tokens. Requires a registered redirect URI and CSRF-resistant ",(0,i.jsx)(t.code,{children:"state"})," handling."]})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.strong,{children:"Refresh Token"})}),(0,i.jsx)(t.td,{children:"Long-lived integrations that need to renew access tokens."}),(0,i.jsx)(t.td,{children:"Exchange a refresh token for a new access token without prompting the user again."})]})]})]}),"\n",(0,i.jsx)(t.h2,{id:"register-an-oauth-application",children:"Register an OAuth application"}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsxs)(t.li,{children:["Sign in to ",(0,i.jsx)(t.code,{children:"https://{organization}.krebit.se/developer/my-apps"}),"."]}),"\n",(0,i.jsxs)(t.li,{children:["Create a new application to obtain a ",(0,i.jsx)(t.code,{children:"client_id"})," and ",(0,i.jsx)(t.code,{children:"client_secret"}),". Secrets are shown only once\u2014store them securely."]}),"\n",(0,i.jsx)(t.li,{children:"Add at least one redirect URI for the Authorization Code flow."}),"\n",(0,i.jsxs)(t.li,{children:["Record your tenant domain (for example, ",(0,i.jsx)(t.code,{children:"yourco.krebit.se"}),") for use in token and API URLs."]}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"authorization-code-example",children:"Authorization Code example"}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsx)(t.p,{children:"Redirect the user to the authorization endpoint:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"https://{organization}.krebit.se/oauth/authorize?client_id={client_id}&redirect_uri={redirect_uri}&response_type=code&state={state}\n"})}),"\n",(0,i.jsxs)(t.p,{children:["Use a cryptographically strong ",(0,i.jsx)(t.code,{children:"state"})," value and persist it temporarily to mitigate CSRF attacks."]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:["Handle the callback, validate ",(0,i.jsx)(t.code,{children:"state"}),", and exchange the authorization code for tokens:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:'curl --request POST \\\n  --url https://{organization}.krebit.se/api/oauth/token \\\n  --header \'Content-Type: application/json\' \\\n  --data \'{\n    "grant_type": "authorization_code",\n    "client_id": "YOUR_CLIENT_ID",\n    "client_secret": "YOUR_CLIENT_SECRET",\n    "redirect_uri": "https://yourapp.example.com/oauth/callback",\n    "code": "AUTH_CODE_FROM_CALLBACK"\n  }\'\n'})}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:["Persist the returned ",(0,i.jsx)(t.code,{children:"access_token"}),", ",(0,i.jsx)(t.code,{children:"refresh_token"}),", and expiry timestamp. Never expose tokens in client-side code or logs."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(t.h3,{id:"refresh-a-token",children:"Refresh a token"}),"\n",(0,i.jsx)(t.p,{children:"Use the refresh token to obtain a new access token without prompting the user again:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:'curl --request POST \\\n  --url https://{organization}.krebit.se/api/oauth/token \\\n  --header \'Content-Type: application/json\' \\\n  --data \'{\n    "grant_type": "refresh_token",\n    "client_id": "YOUR_CLIENT_ID",\n    "client_secret": "YOUR_CLIENT_SECRET",\n    "refresh_token": "STORED_REFRESH_TOKEN"\n  }\'\n'})}),"\n",(0,i.jsx)(t.p,{children:"Always replace the stored refresh token if the response includes a newer value."}),"\n",(0,i.jsx)(t.h2,{id:"send-authenticated-api-calls",children:"Send authenticated API calls"}),"\n",(0,i.jsxs)(t.p,{children:["Attach the bearer token to every request against the ",(0,i.jsx)(t.code,{children:"/api/1.0"})," prefix:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"curl --request GET \\\n  --url https://{organization}.krebit.se/api/1.0/me \\\n  --header 'Authorization: Bearer eyJhbGciOi...'\n"})}),"\n",(0,i.jsx)(t.p,{children:"Expect these status codes while integrating:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"200 OK"})," \u2013 Request succeeded."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"401 Unauthorized"})," \u2013 Token is missing, malformed, or expired."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"403 Forbidden"})," \u2013 The authenticated identity lacks permission to access the requested resource."]}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"security-best-practices",children:"Security best practices"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["Treat the ",(0,i.jsx)(t.code,{children:"client_secret"}),", access tokens, and refresh tokens as sensitive credentials. Rotate them regularly."]}),"\n",(0,i.jsx)(t.li,{children:"Use HTTPS for every request and enforce TLS 1.2 or higher in your HTTP client."}),"\n",(0,i.jsx)(t.li,{children:"Prefer short-lived access tokens cached in memory. Persist refresh tokens in an encrypted store with strict access controls."}),"\n",(0,i.jsxs)(t.li,{children:["Log the ",(0,i.jsx)(t.code,{children:"request_id"})," header (when present) for faster support collaboration, but avoid writing payloads containing personal data to logs."]}),"\n",(0,i.jsxs)(t.li,{children:["Validate redirect URIs and ",(0,i.jsx)(t.code,{children:"state"})," parameters to block CSRF and open-redirect attacks."]}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:(0,i.jsx)(t.code,{children:"invalid_client"})})," \u2013 Confirm the ",(0,i.jsx)(t.code,{children:"client_id"}),", ",(0,i.jsx)(t.code,{children:"client_secret"}),", and tenant domain belong together."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:(0,i.jsx)(t.code,{children:"unsupported_grant_type"})})," \u2013 Double-check the ",(0,i.jsx)(t.code,{children:"grant_type"})," value and ensure the JSON body includes every required field."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsxs)(t.strong,{children:[(0,i.jsx)(t.code,{children:"invalid_grant"})," during refresh"]})," \u2013 The refresh token may be expired or already used. Prompt the user to authenticate again."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"403 responses"})," \u2013 Ensure the authenticated user or integration has the correct roles for the resource you are targeting."]}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["With authentication in place, continue to the ",(0,i.jsx)(t.a,{href:"/docs/getting-started/quickstart-signing",children:"Quickstart"})," to create and send your first signing package."]})]})}function l(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}}}]);